(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34aca749"],{3058:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.articleList}},[a("el-table-column",{attrs:{label:"标题",width:"180",prop:"title"}}),a("el-table-column",{attrs:{label:"时间",width:"180",prop:"date"}}),a("el-table-column",{attrs:{label:"分类",width:"180",prop:"type"}}),a("el-table-column",{attrs:{label:"标签",width:"180",prop:"tag"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v(" 编辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v(" 删除 ")])]}}])})],1),a("Pagination",{attrs:{pageSize:5,total:t.total},on:{currentChange:t.handlePaginationClick}}),a("el-dialog",{attrs:{title:"编辑",visible:t.dialogVisible,width:"60%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("ArticleEdit",{attrs:{defaultData:t.defaultData},on:{handleSubmit:t.handleSubmit}})],1)],1)},n=[],o=(a("a434"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,"page-count":5,total:t.total},on:{"current-change":t.currentChange}})}),r=[],l={name:"Pagination",props:["pageSize","pageCount","total"],data:function(){return{}},methods:{handleDelete:function(){},currentChange:function(t){this.$emit("currentChange",t,this.pageSize)}},created:function(){}},s=l,c=a("2877"),d=Object(c["a"])(s,o,r,!1,null,"0f3bc130",null),u=d.exports,f=a("365c"),p=a("c694"),h={name:"ArticleManage",data:function(){return{articleList:[],total:0,defaultData:{},dialogVisible:!1,PaginationIndex:1,PaginationSize:5}},methods:{handleEdit:function(t,e){this.dialogVisible=!0,this.defaultData=e,this.defaultData.markdown=this.defaultData.content},handleSubmit:function(t){var e=this;Object(f["I"])(this.defaultData._id,t).then((function(t){0===t.data.code?(e.$message({message:t.data.msg,type:"success",duration:2e3}),setTimeout((function(){e.changeArticleList(),e.handleClose()}),2e3)):e.$message({message:"更新失败",type:"success",duration:2e3})})).catch((function(t){e.$message({message:t.data.msg,type:"success",duration:2e3})}))},handleClose:function(){this.dialogVisible=!1},handleDelete:function(t,e){var a=this;Object(f["c"])(e._id).then((function(e){console.log(e),0===e.data.code&&(a.$message({message:"删除成功",type:"success",duration:2e3}),a.articleList.splice(t,1))})).catch((function(){a.$message({message:"删除失败",type:"error",duration:2e3})}))},handlePaginationClick:function(t,e){this.PaginationIndex=t,this.PaginationSize=e,this.changeArticleInfoTotal(),this.changeArticleList()},changeArticleList:function(){var t=this,e=this.PaginationSize*(this.PaginationIndex-1);Object(f["m"])(e,this.PaginationSize).then((function(e){t.articleList=e.data.data})).catch((function(){}))},changeArticleInfoTotal:function(){var t=this;Object(f["k"])().then((function(e){t.total=e.data.data?e.data.data.num:0}))}},mounted:function(){this.changeArticleInfoTotal(),this.changeArticleList(0,5)},components:{ArticleEdit:p["a"],Pagination:u}},m=h,g=Object(c["a"])(m,i,n,!1,null,"3779cced",null);e["default"]=g.exports},a434:function(t,e,a){"use strict";var i=a("23e7"),n=a("23cb"),o=a("a691"),r=a("50c4"),l=a("7b0b"),s=a("65f0"),c=a("8418"),d=a("1dde"),u=a("ae40"),f=d("splice"),p=u("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,m=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!f||!p},{splice:function(t,e){var a,i,d,u,f,p,v=l(this),S=r(v.length),w=n(t,S),y=arguments.length;if(0===y?a=i=0:1===y?(a=0,i=S-w):(a=y-2,i=m(h(o(e),0),S-w)),S+a-i>g)throw TypeError(b);for(d=s(v,i),u=0;u<i;u++)f=w+u,f in v&&c(d,u,v[f]);if(d.length=i,a<i){for(u=w;u<S-i;u++)f=u+i,p=u+a,f in v?v[p]=v[f]:delete v[p];for(u=S;u>S-i+a;u--)delete v[u-1]}else if(a>i)for(u=S-i;u>w;u--)f=u+i-1,p=u+a-1,f in v?v[p]=v[f]:delete v[p];for(u=0;u<a;u++)v[u+w]=arguments[u+2];return v.length=S-i+a,d}})},ae40:function(t,e,a){var i=a("83ab"),n=a("d039"),o=a("5135"),r=Object.defineProperty,l={},s=function(t){throw t};t.exports=function(t,e){if(o(l,t))return l[t];e||(e={});var a=[][t],c=!!o(e,"ACCESSORS")&&e.ACCESSORS,d=o(e,0)?e[0]:s,u=o(e,1)?e[1]:void 0;return l[t]=!!a&&!n((function(){if(c&&!i)return!0;var t={length:-1};c?r(t,1,{enumerable:!0,get:s}):t[1]=1,a.call(t,d,u)}))}},c694:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.rules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"分类",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择分类"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-option",{attrs:{label:"原创",value:"原创"}}),a("el-option",{attrs:{label:"转载",value:"转载"}})],1)],1),a("el-form-item",{attrs:{label:"标签",prop:"tag"}},[a("el-select",{attrs:{placeholder:"请选择标签"},model:{value:t.form.tag,callback:function(e){t.$set(t.form,"tag",e)},expression:"form.tag"}},[a("el-option",{attrs:{label:"HTML&CSS",value:"HTML&Css"}}),a("el-option",{attrs:{label:"JavaScript",value:"JavaScript"}}),a("el-option",{attrs:{label:"Node",value:"Node"}}),a("el-option",{attrs:{label:"Vue&React",value:"Vue&React"}})],1)],1),a("el-form-item",{attrs:{label:"封面",prop:"surface"}},[a("Upload",{on:{uploadSuccess:t.uploadSuccess}})],1),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("MarkdownEditor",{ref:"editorMd",attrs:{options:t.editorOptions,id:"edit"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v(" 发表文章 ")])],1)],1)],1)},n=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:t.id}})},r=[],l=a("1157"),s=a.n(l),c={name:"MarkdownEditor",data:function(){return{editor:null,defaultOptions:{width:"100%",height:540,path:"/lib/editor.md-master/lib/",theme:"dark",previewTheme:"dark",editorTheme:"pastel-on-dark",markdown:"",codeFold:!0,saveHTMLToTextarea:!0,searchReplace:!0,htmlDecode:"style,script,iframe|on*",toolbar:!0,previewCodeHighlight:!0,emoji:!0,taskList:!0,tocm:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,dialogLockScreen:!1,dialogShowMask:!1,dialogDraggable:!1,dialogMaskOpacity:.4,dialogMaskBgColor:"#ccc",imageUpload:!0,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"/admin/article/img",onload:function(){console.log("加载完成")}},content:""}},props:{id:{type:String,default:"editor"},options:{type:Object}},updated:function(){console.log("更新了");var t=this;this.requireEditor((function(){t.editor=editormd(t.id,t.getOptions())}))},mounted:function(){var t=this;this.requireEditor((function(){t.editor=editormd(t.id,t.getOptions())}))},methods:{requireEditor:function(t){window.$=window.jQuery=s.a,s.a.getScript("/lib/editor.md-master/editormd.min.js",(function(e){t()})),s()("head").append(s()('<link rel="stylesheet" type="text/css" />').attr("href","/lib/editor.md-master/css/editormd.min.css"))},getOptions:function(){return Object.assign(this.defaultOptions,this.options)},handleClick:function(){this.$emit("Sub",this)}}},d=c,u=a("2877"),f=Object(u["a"])(d,o,r,!1,null,"16c87500",null),p=f.exports,h=a("d443"),m={name:"ArticleEdit",props:["defaultData"],data:function(){var t=this;return{form:{title:this.defaultData.title||"",tag:this.defaultData.tag||"",type:this.defaultData.type||"",surface:this.defaultData.surface||"",content:this.defaultData.content||""},rules:{type:[{required:!0,message:"请选择分类"}],title:[{required:!0,message:"请输入标题"}],tag:[{required:!0,message:"请选择标签"}],surface:[{required:!0,message:"请选择封面"}],content:{validator:function(e,a,i){t.$refs.editorMd.editor.getHTML()?i():i(new Error("请输入文章内容"))},required:!0}},editorOptions:{markdown:""}}},watch:{defaultData:function(){this.form={title:this.defaultData.title,type:this.defaultData.type,tag:this.defaultData.tag,content:this.defaultData.content,surface:this.defaultData.surface,contentHTML:this.defaultData.contentHTML}}},methods:{uploadSuccess:function(t){this.form.surface=t},onSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.$emit("handleSubmit",{type:e.form.type,title:e.form.title,tag:e.form.tag,surface:e.form.surface,content:e.$refs.editorMd.editor.getMarkdown(),contentHTML:e.$refs.editorMd.editor.getHTML()})}))}},components:{MarkdownEditor:p,Upload:h["a"]},created:function(){this.editorOptions=this.defaultData},destroyed:function(){}},g=m,b=Object(u["a"])(g,i,n,!1,null,"2b36bc0f",null);e["a"]=b.exports},d443:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-upload",{attrs:{action:"http://localhost:3000/admin/upload/articleSurface","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{width:"300",src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])},n=[],o=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),{name:"Upload",data:function(){return{imageUrl:""}},methods:{handleAvatarSuccess:function(t,e){this.$emit("uploadSuccess",t.surface),this.imageUrl=URL.createObjectURL(e.raw)},beforeAvatarUpload:function(t){var e=/^(image\/jpeg|image\/jpg|image\/png|image\/gif)$/.test(t.type);return e||this.$message.error("图片只能是 JPG/JPEG/PNG/GIF 格式!"),e}}}),r=o,l=a("2877"),s=Object(l["a"])(r,i,n,!1,null,"c8448796",null);e["a"]=s.exports}}]);
//# sourceMappingURL=chunk-34aca749.365fb767.js.map