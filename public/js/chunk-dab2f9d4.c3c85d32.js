(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dab2f9d4"],{"216c":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{attrs:{id:"nav"}},[r("div",{staticClass:"nav-main"},[r("div",{staticClass:"n-m-logo"},[e._v("BaiLing")]),r("div",{staticClass:"n-m-login"},[e.ifLogin?r("el-popover",{attrs:{placement:"top-start",width:"100",trigger:"hover"}},[r("p",[e._v("欢迎登陆："+e._s(e.login.user))]),r("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:e.handleLogout}},[e._v("退出登录")]),r("br"),r("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){e.ifShowAvatar=!0}}},[e._v(" 修改头像 ")]),r("a",{staticClass:"img",style:{backgroundImage:"url("+e.login.photo+")",position:"absolute",top:"10px",left:"41px",width:"40px",height:"40px",backgroundPosition:"center center",backgroundSize:"cover",borderRadius:"50%",cursor:"pointer"},attrs:{slot:"reference",href:""},slot:"reference"})],1):r("div",{staticClass:"login"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.ifShowLogin=!0}}},[e._v("登录")]),r("el-button",{attrs:{type:"success"},on:{click:function(t){e.ifShowRegister=!0}}},[e._v("注册")])],1)],1),r("div",{staticClass:"n-m-nav"},[r("ul",{class:"list"+e.whichActive},[r("li",[r("router-link",{attrs:{to:"/"}},[e._v("首页")])],1),r("li",[r("router-link",{attrs:{to:"/blog/0"}},[e._v("博客")])],1),r("li",[r("router-link",{attrs:{to:"/message"}},[e._v("留言")])],1),r("li",[r("router-link",{attrs:{to:"/diary"}},[e._v("日记")])],1),r("li",[r("router-link",{attrs:{to:"/links"}},[e._v("友链")])],1),r("li",[r("router-link",{attrs:{to:"/about"}},[e._v("关于")])],1)])])])]),r("Login",{attrs:{dialogVisible:e.ifShowLogin},on:{handleClose:e.closeLogin}}),r("Register",{attrs:{dialogVisible:e.ifShowRegister},on:{handleClose:e.closeRegister}}),r("Avatar",{attrs:{dialogVisible:e.ifShowAvatar},on:{handleClose:e.closeAvatar}})],1)},o=[],s=(r("c975"),r("b0c0"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"注册",visible:e.dialogVisible,width:"30%","before-close":e.beforeClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[r("el-form-item",{attrs:{label:"用户名",prop:"user"}},[r("el-input",{model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[r("el-input",{attrs:{"show-password":""},model:{value:e.form.pwd,callback:function(t){e.$set(e.form,"pwd",t)},expression:"form.pwd"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"checkPwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.form.checkPwd,callback:function(t){e.$set(e.form,"checkPwd",t)},expression:"form.checkPwd"}})],1),r("el-form-item",{staticClass:"vcode",attrs:{label:"验证码",prop:"svgCode"}},[r("el-input",{model:{value:e.form.svgCode,callback:function(t){e.$set(e.form,"svgCode",t)},expression:"form.svgCode"}}),r("div",{staticClass:"svg",domProps:{innerHTML:e._s(e.register.svgText)}}),r("el-link",{attrs:{type:"primary",disabled:e.register.disabled},on:{click:e.getVCode}},[e._v(e._s(e.register.refreshText))])],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",disabled:e.register.submitDisabled},on:{click:e.handleClick}},[e._v("立即注册")])],1)],1)}),a=[],n=r("365c"),l={name:"Register",data:function(){var e=this;return{form:{user:"",pwd:"",checkPwd:"",svgCode:""},rules:{user:[{required:!0,message:"请输入用户名",trigger:"blur"},{type:"string",pattern:/^[\w\u4e00-\u9fa5\uac00-\ud7ff\u0800-\u4e00\-]{2,7}$/,message:"2-7位，数字 字母 _ - 中日韩文",trigger:["blur","change"]}],pwd:{type:"string",validator:function(t,r,i){r?/^[\w<>,.?|;':"{}!@#$%^&*()\/\-\[\]\\]{6,18}$/.test(r)?i():i(new Error("6-18位，不允许出现奇怪的字符哦~")):i(new Error("请输入密码")),e.form.checkPwd&&e.$refs.form.validateField("checkPwd")},required:!0,message:"6-18位，不允许出现奇怪的字符",trigger:["blur","change"]},checkPwd:{validator:function(t,r,i){r?r===e.form.pwd?i():i(new Error("两次密码不一致")):i(new Error("请再次输入密码"))},required:!0,trigger:["blur","change"]},svgCode:{validator:function(e,t,r){t?Object(n["v"])(t).then((function(e){0===e.data.code?r():r(new Error("验证码错误"))})).catch((function(){r(new Error("未知错误…"))})):r(new Error("请输入验证码！"))},required:!0,trigger:"blur"}},register:{svgText:"loading...",refreshText:"刷新",disabled:!0,timer:null,submitDisabled:!1}}},props:["dialogVisible"],methods:{getVCode:function(){var e=this;Object(n["w"])().then((function(t){clearTimeout(e.register.timer);var r=0,i=function(){r+=1e3,r>t.data.time?(clearTimeout(e.register.timer),e.register.disabled=!1,e.register.refreshText="刷新"):(e.register.disabled=!0,e.register.refreshText=((t.data.time-r)/1e3|0)+"s后可以刷新")};e.register.timer=setInterval(i,1e3),i(),e.register.svgText=t.data.data}))},handleClick:function(){var e=this;this.register.submitDisabled=!0,this.$refs["form"].validate((function(t){if(!t)return e.register.submitDisabled=!1,!1;Object(n["G"])(e.form).then((function(t){e.getVCode(),t.data.code?(e.$message({message:t.data.msg,type:"error",duration:2e3}),e.register.submitDisabled=!1):(e.$message({message:"注册成功！",type:"success",duration:2e3}),setTimeout((function(){e.register.submitDisabled=!1,e.$emit("handleClose",!0)}),1800))})).catch((function(){e.register.submitDisabled=!1,e.getVCode(),e.$message({message:"注册失败请稍后再试~",type:"error",duration:2e3})}))}))},beforeClose:function(){var e=this;this.$confirm("确认关闭？").then((function(){e.$emit("handleClose",!1)})).catch((function(){}))}},mounted:function(){this.getVCode()},destroyed:function(){clearTimeout(this.register.timer)}},c=l,u=(r("7211"),r("2877")),d=Object(u["a"])(c,s,a,!1,null,"38f76a94",null),f=d.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"登录",visible:e.dialogVisible,width:"30%","before-close":e.beforeClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[r("el-form-item",{attrs:{label:"用户名",prop:"user"}},[r("el-input",{model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[r("el-input",{attrs:{"show-password":""},model:{value:e.form.pwd,callback:function(t){e.$set(e.form,"pwd",t)},expression:"form.pwd"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",disabled:e.submitDisabled},on:{click:e.handleClick}},[e._v("登录")])],1)],1)},m=[],h={name:"Register",data:function(){var e=this;return{form:{user:"",pwd:""},rules:{user:[{required:!0,message:"请输入用户名",trigger:"blur"},{type:"string",pattern:/^[\w\u4e00-\u9fa5\uac00-\ud7ff\u0800-\u4e00\-]{2,7}$/,message:"请输入正确格式用户名",trigger:["blur","change"]}],pwd:{type:"string",validator:function(t,r,i){r?/^[\w<>,.?|;':"{}!@#$%^&*()\/\-\[\]\\]{6,18}$/.test(r)?i():i(new Error("请输入正确格式密码")):i(new Error("请输入密码")),e.form.checkPwd&&e.$refs.form.validateField("checkPwd")},required:!0,trigger:["blur","change"]}},submitDisabled:!1}},props:["dialogVisible"],methods:{handleClick:function(){var e=this;this.submitDisabled=!0,this.$refs["form"].validate((function(t){if(!t)return e.submitDisabled=!1,!1;Object(n["E"])(e.form).then((function(t){t.data.code?(e.submitDisabled=!1,e.$message({message:t.data.msg,type:"error",duration:2e3})):(e.$message({message:t.data.msg,type:"success",duration:2e3}),setTimeout((function(){e.submitDisabled=!1,e.$emit("handleClose"),window.location.reload()}),1800))})).catch((function(){e.$message({message:"登录失败请稍后再试~",type:"error",duration:2e3}),e.submitDisabled=!1}))}))},beforeClose:function(){this.$emit("handleClose")}},mounted:function(){},destroyed:function(){}},p=h,b=(r("9a4f"),Object(u["a"])(p,g,m,!1,null,"447db40f",null)),v=b.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"头像上传",visible:e.dialogVisible,width:"30%","before-close":e.beforeClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://localhost:3000/upload/avatar","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"with-credentials":!0}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)},C=[],k=(r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),{name:"Avatar",data:function(){return{imageUrl:""}},props:["dialogVisible"],methods:{handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.$message({message:"头像上传成功",type:"success",duration:2e3}),setTimeout((function(){window.location.reload()}),1700)},beforeAvatarUpload:function(e){var t=/^(image\/jpeg|image\/png|image\/gif)$/.test(e.type),r=e.size/1024<100;return t||this.$message.error("上传头像图片只能是 JPG/PNG/GIF 格式!"),r||this.$message.error("上传头像图片大小不能超过 50K !"),t&&r},beforeClose:function(){this.$emit("handleClose")}}}),$=k,y=(r("b704"),Object(u["a"])($,w,C,!1,null,null,null)),x=y.exports,_={name:"Nav",components:{Register:f,Login:v,Avatar:x},data:function(){return{routerList:["Home","Blog","Message","Diary","Links","About"],ifLogin:!1,login:{user:"",photo:""},ifShowLogin:!1,ifShowRegister:!1,ifShowAvatar:!1}},computed:{whichActive:function(){var e=this.routerList.indexOf(this.$route.name);return"Article"===this.$route.name&&(e=1),e+1}},methods:{closeRegister:function(e){this.ifShowRegister=!1,this.ifShowLogin=e},closeLogin:function(){this.ifShowLogin=!1},closeAvatar:function(){this.ifShowAvatar=!1},handleLogout:function(){var e=this;Object(n["F"])().then((function(){e.$message({message:"退出登录成功",type:"success",duration:2e3}),setTimeout((function(){window.location.reload()}),1700)})).catch((function(){e.$message({message:"退出失败…",type:"error",duration:2e3})}))},handleAvatar:function(){}},mounted:function(){var e=this;Object(n["D"])().then((function(t){t.data.userInfo?(e.ifLogin=!0,e.login.user=t.data.userInfo.user,e.login.photo=t.data.userInfo.photo):e.ifLogin=!1}))}},S=_,A=(r("6f8c"),Object(u["a"])(S,i,o,!1,null,"3164cd6a",null));t["a"]=A.exports},4013:function(e,t,r){},"4fef":function(e,t,r){},"6f8c":function(e,t,r){"use strict";var i=r("4fef"),o=r.n(i);o.a},7211:function(e,t,r){"use strict";var i=r("f9f8"),o=r.n(i);o.a},8386:function(e,t,r){},"9a4f":function(e,t,r){"use strict";var i=r("4013"),o=r.n(i);o.a},a640:function(e,t,r){"use strict";var i=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&i((function(){r.call(null,t||function(){throw 1},1)}))}},ae40:function(e,t,r){var i=r("83ab"),o=r("d039"),s=r("5135"),a=Object.defineProperty,n={},l=function(e){throw e};e.exports=function(e,t){if(s(n,e))return n[e];t||(t={});var r=[][e],c=!!s(t,"ACCESSORS")&&t.ACCESSORS,u=s(t,0)?t[0]:l,d=s(t,1)?t[1]:void 0;return n[e]=!!r&&!o((function(){if(c&&!i)return!0;var e={length:-1};c?a(e,1,{enumerable:!0,get:l}):e[1]=1,r.call(e,u,d)}))}},b0c0:function(e,t,r){var i=r("83ab"),o=r("9bf2").f,s=Function.prototype,a=s.toString,n=/^\s*function ([^ (]*)/,l="name";i&&!(l in s)&&o(s,l,{configurable:!0,get:function(){try{return a.call(this).match(n)[1]}catch(e){return""}}})},b704:function(e,t,r){"use strict";var i=r("8386"),o=r.n(i);o.a},c975:function(e,t,r){"use strict";var i=r("23e7"),o=r("4d64").indexOf,s=r("a640"),a=r("ae40"),n=[].indexOf,l=!!n&&1/[1].indexOf(1,-0)<0,c=s("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:l||!c||!u},{indexOf:function(e){return l?n.apply(this,arguments)||0:o(this,e,arguments.length>1?arguments[1]:void 0)}})},f9f8:function(e,t,r){}}]);
//# sourceMappingURL=chunk-dab2f9d4.c3c85d32.js.map